<main>
        <div class="col-item">           
            <section class="mb-5form">
                <form class="form-principal" [formGroup]="form">
                    <div class="container">
                        <h3 class="mb-3">{{ editingMode ? 'Editar' : 'Agregar' }} Socio</h3>
                        <div class="bg-light p-4 rounded">
                            <div class="row mb-3">
                                <div class="col-lg-12"> 
                                    <label for="NombreGasto" class="form-label">NombreGasto: </label>
                                    <input type="text" formControlName="NombreGasto" class="form-control">
                                    <div *ngIf="NombreGasto.invalid && (NombreGasto.dirty || NombreGasto.touched)">
                                        <p *ngIf="NombreGasto.errors['required']" class="error-message">Campo requerido</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-lg-12"> 
                                    <label for="Fecha" class="form-label">Fecha: </label>
                                    <input type="Date" formControlName="Fecha" class="form-control">
                                    <div *ngIf="form.get('Fecha').invalid && (form.get('Fecha').dirty || form.get('Fecha').touched)">
                                        <p *ngIf="form.get('Fecha').errors['required']" class="error-message">Campo requerido</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-lg-3">
                                <div class="Detalles">
                                    <label for="DetallePago" class="form-label">Detalles del Gasto: </label>
                                    <hr>
                                    <textarea formControlName="DetallePago" class="form-control" rows="5" maxlength="250"></textarea>
                                    <div *ngIf="form.get('DetallePago').invalid && (form.get('DetallePago').dirty || form.get('DetallePago').touched)">
                                        <p *ngIf="form.get('DetallePago').errors['required']" class="error-message">Campo requerido</p>
                                    </div> 
                                </div>
                            </div>
                            <hr>
                            <div class="col-lg-3">
                        
                                <label for="MetodoPago" class="form-label">Metodo de Pago: </label>
                                
                                <input type="text" formControlName="MetodoPago" class="form-control">
                                <div *ngIf="MetodoPago.invalid && (MetodoPago.dirty || MetodoPago.touched)">
                                    <p *ngIf="MetodoPago.errors['required']" class="error-message">Campo requerido</p>
                                
                                </div>
                                <hr>
                            </div>

                            <div class="row mb-3">
                                <div class="col-lg-12">
                                    <label for="Proveedor" class="form-label">Proveedor: </label>
                                    <select formControlName="Proveedor" class="form-control">
                                        <option *ngFor="let proveedor of proveedores" [value]="proveedor.id">{{ proveedor.nombre }}</option>
                                    </select>
                                    <div *ngIf="form.get('Proveedor').invalid && (form.get('Proveedor').dirty || form.get('Proveedor').touched)">
                                        <p *ngIf="form.get('Proveedor').errors['required']" class="error-message">Campo requerido</p>
                                    </div>
                                </div>
                            </div>
                            <hr class="mb-4">
                            <button type="button" class="btn btn-primary" [disabled]="!form.valid" (click)="addGasto()">
                                {{ editingMode ? 'Actualizar' : 'Agregar' }}
                              </button>
                        </div>
                    </div>
                </form>

                <div class="restante">
                <div class="row mb-3">
                    <div class="col-lg-12">
                      <button class="btn btn-primary" (click)="activarModoBusqueda()">Opciones Avanzadas</button>
                    </div>
                  </div>
                <div class="opciones">  
                <form class="opciones" [formGroup]="modoBusqueda ? formBusqueda : form">
                    <div class="row mb-3" *ngIf="modoBusqueda">
                      <div class="col-lg-12">
                            <div class="opcion">
                                <label for="FechaBusqueda" class="form-label">Buscar por fecha: </label>
                                <hr>
                                <input type="Date" formControlName="fechaBusqueda" class="form-control">
                                <button *ngIf="modoBusqueda" type="button" class="btn btn-primary" (click)="buscarGastoXFecha()">Buscar</button>
                            </div>
                            
                            <div class="opcion">
                                <label class="form-label">Buscar por mes:</label>
                                <hr>
                                <input type="month" formControlName="mesSeleccionado" class="form-control">
                                <button  *ngIf ="modoBusqueda" class="btn btn-primary" (click)="buscarGastoXMes()">Buscar</button>
                            </div>
                           
                            <div class="opcion">
                                <label for="form-label"> Buscar por proveedor en fecha</label>
                                <hr>
                                <div class="col-lg-6">
                                    <label for="fechaProveedor" class="form-label">Seleccionar Fecha:</label>
                                    <input type="date" formControlName="fechaProveedor" class="form-control">
                                  </div>
                                <div class="col-lg-6">
                                    <form class="form-proveedor">
                                        <mat-form-field >
                                            <mat-label>Nombre del Proveedor</mat-label>
                                                <input 
                                                type="text"
                                                matInput
                                                placeholder="Selccione Proveedor"
                                                [matAutocomplete]="auto"
                                                [formControl] = "formSeleccionProveedor"
                                                (input)="filtrarProveedor($event)"
                                                >
                                                <mat-autocomplete requireSelection #auto="matAutocomplete"
                                                (optionSelected)="seleccionarProveedor($event.option.value)">
                                                    <mat-option *ngFor="let proveedor of proveedoresFiltrados"[value]="proveedor">
                                                        {{proveedor.nombre}} {{proveedor.categoria}}
                                                    </mat-option>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </form>
                                  </div>

                                  <button *ngIf ="modoBusqueda" class="btn btn-primary" (click)="fechaProveedorSelecionada()">Buscar</button>
                               

                            </div>
                            <div class="opcion">
                                <label class="form-label">Buscar entre Fechas elegidas</label>
                                <hr>
                                Inicio: <input type="Date" formControlName="fechaInicio" class="form-control">
                                Fin: <input type="Date" formControlName="fechaFin" class="form-control">
                                <button  *ngIf ="modoBusqueda" class="btn btn-primary" (click)="EntreFechas()">Buscar</button>
                            </div>  
                        </div>
                    </div>
                

                    <div class="row mb-3">
                      <div class="col-lg-12">

                        
                        <button *ngIf="modoBusqueda" type="button" class="btn btn-secondary" (click)="modoBusqueda = false">Volver al Modo Normal</button>
 
                      </div>
                    </div>
                  </form>
                </div>
                </div>
            </section>
        </div> 
        <hr>
        <div class="row">
            <div class="col-tabla">  


                <section id="listado">
                <h2 class="mb-4">Lista de Gastos</h2>
                <button class="btn btn-primary" (click)="desactivarModoBusqueda()">Volver a cargar </button>
                <table class="table table-striped">
                <thead class="thead-dark">
                    <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Nombre del Gasto</th>
                    <th scope="col">Fecha</th>
                    <th scope="col">Monto del Gasto</th>
                    <th scope="col">MÃ©todo de Pago</th>
                    <th scope="col">Detalle del Gasto</th>
                    <th scope="col">Proveedor</th>
                    <th scope="col">Opciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let gasto of listaGasto">
                    <th scope="row">{{ gasto.id }}</th>
                    <td>{{ gasto.nombreGasto }}</td>
                    <td>{{ gasto.fecha | date:'dd/MM/yyyy' }}</td>
                    <td>{{ gasto.montoGasto }}</td>
                    <td>{{ gasto.metodoPago }}</td>
                    <td><button class="btn btn-secondary" (click)="mostrarDetalles(gasto.detalleGasto)">Detalles</button></td>
                    <td>{{ gasto.proveedor ? gasto.proveedor.nombre : '' }}</td>
                    <td>
                        <button class="btn btn-secondary" (click)="editGasto(gasto)">Editar</button>
                        <button class="btn btn-secondary"  (click)="delete(gasto.id)">Borrar</button>
                    </td>
                    </tr>
                </tbody>
            </table>
        </section>
            </div>
        </div>
</main>
